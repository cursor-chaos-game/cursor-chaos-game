<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CHAOS RUNNER: ASCENSION V4.0</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');

        * { margin: 0; padding: 0; box-sizing: border-box; user-select: none; }
        body { background-color: #050505; overflow: hidden; font-family: 'Orbitron', sans-serif; cursor: none; } 

        /* GÖRSEL KATMANLAR */
        #gameCanvas { display: block; width: 100%; height: 100%; }
        .ui-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; display: flex; flex-direction: column; }
        
        /* HUD */
        #hud { padding: 20px; display: none; justify-content: space-between; align-items: flex-start; color: #fff; }
        .stat-block { text-align: center; text-shadow: 0 0 10px rgba(0,255,255,0.5); }
        .stat-value { font-size: 24px; font-weight: 900; display: block; }
        .stat-label { font-size: 10px; color: #888; letter-spacing: 2px; }

        /* MENÜ */
        #menuScreen, #gameOverScreen {
            position: absolute; width: 100%; height: 100%;
            background: radial-gradient(circle, #1a1a1a 0%, #000 100%);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            pointer-events: auto; z-index: 20;
        }
        
        h1 {
            font-size: clamp(40px, 10vw, 80px); text-align: center;
            background: linear-gradient(90deg, #ff0055, #00ffff); -webkit-background-clip: text; color: transparent;
            text-shadow: 0 0 20px rgba(255,0,85,0.5); margin-bottom: 10px;
            animation: glitch 3s infinite;
        }

        button {
            background: transparent; border: 2px solid #00ffff; color: #00ffff;
            padding: 15px 50px; font-size: 18px; font-family: 'Orbitron', sans-serif; font-weight: bold;
            cursor: pointer; clip-path: polygon(10% 0, 100% 0, 100% 70%, 90% 100%, 0 100%, 0 30%);
            transition: all 0.2s; box-shadow: 0 0 15px rgba(0, 255, 255, 0.2);
        }
        button:hover { background: rgba(0,255,255,0.1); }
        button:active { transform: scale(0.95); background: rgba(0,255,255,0.2); }
        
        /* Gelişmiş CSS efektleri */
        #zoneTitle { opacity: 0; transition: opacity 2s; }
        #vignette { background: radial-gradient(circle, transparent 40%, black 120%); }
    </style>
</head>
<body>

    <canvas id="gameCanvas"></canvas>
    <div id="vignette"></div>
    <div id="scanline"></div>

    <div id="zoneTitle"></div>

    <div id="hud" class="ui-layer">
        <div class="stat-block">
            <span class="stat-value" id="scoreVal">0</span>
            <span class="stat-label">SKOR</span>
        </div>
        <div class="stat-block">
            <span class="stat-value" id="waveVal">1</span>
            <span class="stat-label" style="color:#ff0055">DALGA</span>
        </div>
        <div class="stat-block">
            <span class="stat-value" id="healthVal">100%</span>
            <span class="stat-label" style="color:#00ff00">DURUM</span>
        </div>
        <div class="stat-block" style="position: absolute; bottom: 20px; right: 20px;">
            <span class="stat-value" id="ammoVal">∞</span>
            <span class="stat-label" style="color:#00ffff">MÜHİMMAT</span>
        </div>
    </div>

    <div id="menuScreen">
        <h1>CHAOS RUNNER: ASCENSION</h1>
        <div class="subtitle">Mouse ile Hareketi Kontrol Et, Sol Tık ile Ateş Et, Sağ Tık ile Atıl</div>
        <button onclick="Game.init()">SİSTEMİ BAŞLAT</button>
        <div style="margin-top:20px; color:#444; font-size:10px;">V4.0 PC FINAL CORE ENGINE</div>
    </div>

    <div id="gameOverScreen" style="display:none;">
        <div class="death-msg">BAĞLANTI KOPTU</div>
        <div class="subtitle">Kalan Dalga: <span id="finalWave">0</span> | Nihai Skor: <span id="finalScore">0</span></div>
        <button onclick="Game.restart()">YENİDEN BAĞLAN</button>
    </div>

<script>
// --- CORE TOOLS ---

const AudioEngine = {
    ctx: null,
    init: function() {
        document.addEventListener('click', () => {
            if (!this.ctx) this.ctx = new (window.AudioContext || window.webkitAudioContext)();
        }, { once: true });
    },
    playTone: function(freq, type, duration, vol) {
        if(!this.ctx) return;
        const osc = this.ctx.createOscillator();
        const gain = this.ctx.createGain();
        osc.type = type;
        osc.frequency.setValueAtTime(freq, this.ctx.currentTime);
        gain.gain.setValueAtTime(vol, this.ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.001, this.ctx.currentTime + duration);
        osc.connect(gain);
        gain.connect(this.ctx.destination);
        osc.start();
        osc.stop(this.ctx.currentTime + duration);
    },
    sfx: {
        dash: () => AudioEngine.playTone(600, 'sawtooth', 0.2, 0.1),
        hit: () => AudioEngine.playTone(100, 'square', 0.5, 0.2),
        shoot: () => AudioEngine.playTone(800, 'sine', 0.05, 0.08),
        collect: () => AudioEngine.playTone(1200, 'sine', 0.1, 0.1),
        wave: () => AudioEngine.playTone(50, 'sawtooth', 2.0, 0.3)
    }
};

const VFX = {
    particles: [],
    shakeTimer: 0,
    
    addParticle: function(x, y, color, speed, count=10) {
        for(let i=0; i<count; i++) {
            this.particles.push({
                x: x, y: y,
                vx: (Math.random() - 0.5) * speed,
                vy: (Math.random() - 0.5) * speed,
                life: 1.0,
                color: color
            });
        }
    },
    
    update: function(ctx) {
        // Shake logic
        if(this.shakeTimer > 0) {
            const mag = this.shakeTimer * 0.5;
            ctx.translate((Math.random()-0.5)*mag, (Math.random()-0.5)*mag);
            this.shakeTimer *= 0.9;
            if(this.shakeTimer < 0.5) this.shakeTimer = 0;
        }

        // Particles
        for(let i = this.particles.length - 1; i >= 0; i--) {
            let p = this.particles[i];
            p.x += p.vx;
            p.y += p.vy;
            p.life -= 0.03;
            
            ctx.globalAlpha = p.life;
            ctx.fillStyle = p.color;
            ctx.fillRect(p.x, p.y, 3, 3);
            ctx.globalAlpha = 1.0;
            
            if(p.life <= 0) this.particles.splice(i, 1);
        }
    },
    
    shake: function(amount) {
        this.shakeTimer = amount;
    }
};

// --- DATA CONFIGURATION (Kusursuz Zorluk Eğrisi) ---

const Zones = [
    { name: "NEON CITY", start: 1, end: 10, color: "#00ffff", enemyTypes: ['seeker'] },
    { name: "FOUNDRY SECTOR", start: 11, end: 30, color: "#ffaa00", enemyTypes: ['seeker', 'drone'] },
    { name: "SKYBRIDGE", start: 31, end: 60, color: "#00ff00", enemyTypes: ['seeker', 'drone', 'heavy'] },
    { name: "ABYSSAL VAULT", start: 61, end: 90, color: "#ff0055", enemyTypes: ['seeker', 'drone', 'heavy', 'turret'] },
    { name: "FINAL CORE", start: 91, end: 100, color: "#ffffff", enemyTypes: ['all'] }
];

// --- GAME OBJECTS ---

class Player {
    constructor() {
        this.x = window.innerWidth / 2;
        this.y = window.innerHeight / 2;
        this.radius = 15;
        this.color = '#00ffff';
        this.trail = [];
        this.dashCooldown = 0; // Cooldown: 60 frame
        this.fireCooldown = 0; // Cooldown: 10 frame
        this.health = 100;
        this.targetX = this.x;
        this.targetY = this.y;
        this.isDashing = false;
        this.keys = {}; // WASD durumu
    }
    
    update() {
        // Klavye Hareket Hedefi (WASD)
        let moveX = 0;
        let moveY = 0;
        if (this.keys['KeyW'] || this.keys['ArrowUp']) moveY -= 1;
        if (this.keys['KeyS'] || this.keys['ArrowDown']) moveY += 1;
        if (this.keys['KeyA'] || this.keys['ArrowLeft']) moveX -= 1;
        if (this.keys['KeyD'] || this.keys['ArrowRight']) moveX += 1;

        if (moveX !== 0 || moveY !== 0) {
            // Klavye ile hedefi güncelle (Fareyi de dahil et)
            this.targetX = this.x + moveX * 20; 
            this.targetY = this.y + moveY * 20;
        }

        // Hareketi yumuşat
        this.x += (this.targetX - this.x) * 0.15; // Daha hızlı tepki
        this.y += (this.targetY - this.y) * 0.15;
        
        // Sınırlar
        this.x = Math.max(20, Math.min(window.innerWidth-20, this.x));
        this.y = Math.max(20, Math.min(window.innerHeight-20, this.y));

        // Cooldown
        if(this.dashCooldown > 0) this.dashCooldown--;
        if(this.fireCooldown > 0) this.fireCooldown--;
        this.isDashing = this.dashCooldown > 40;

        // Trail
        this.trail.push({x: this.x, y: this.y, alpha: 0.8});
        if(this.trail.length > 10) this.trail.shift();
    }

    // SAĞ TIK: DASH
    dash() {
        if(this.dashCooldown > 0) return;
        this.dashCooldown = 60;
        this.isDashing = true;
        VFX.shake(10);
        AudioEngine.sfx.dash();
        
        const dx = this.targetX - this.x;
        const dy = this.targetY - this.y;
        const dist = Math.sqrt(dx*dx + dy*dy);

        if(dist > 0) {
            this.x += (dx/dist) * 150; // Daha uzun atılma
            this.y += (dy/dist) * 150;
            VFX.addParticle(this.x, this.y, '#fff', 10, 15);
        }
    }
    
    // SOL TIK: ATEŞ ETME
    shoot() {
        if(this.fireCooldown > 0) return;
        this.fireCooldown = 10; // Hızlı atış
        AudioEngine.sfx.shoot();
        
        // Fare'nin gösterdiği yöne ateş et
        const dx = this.targetX - this.x;
        const dy = this.targetY - this.y;
        const dist = Math.sqrt(dx*dx + dy*dy);
        
        if (dist > 0) {
            Game.shots.push(new Shot(this.x, this.y, dx / dist, dy / dist));
        }
    }

    draw(ctx) {
        // İzi çiz
        this.trail.forEach(t => {
            ctx.beginPath();
            ctx.arc(t.x, t.y, this.radius * 0.8, 0, Math.PI*2);
            ctx.fillStyle = `rgba(0, 255, 255, ${t.alpha * 0.3})`;
            ctx.fill();
        });

        // Karakteri çiz
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.radius, 0, Math.PI*2);
        
        const baseColor = this.health < 40 ? '#ff0055' : this.color;
        ctx.fillStyle = this.isDashing ? '#fff' : baseColor; 
        
        ctx.shadowBlur = this.isDashing ? 30 : 20;
        ctx.shadowColor = this.isDashing ? '#fff' : baseColor;
        ctx.fill();
        ctx.shadowBlur = 0;
    }
}

class Shot {
    constructor(x, y, vx, vy) {
        this.x = x;
        this.y = y;
        this.vx = vx * 25; // Hızlı mermi
        this.vy = vy * 25;
        this.radius = 4;
        this.color = '#ff0055';
        this.active = true;
        this.damage = 1;
    }

    update() {
        this.x += this.vx;
        this.y += this.vy;
        
        // Ekran dışına çıkınca sil
        if(this.x < 0 || this.x > window.innerWidth || this.y < 0 || this.y > window.innerHeight) {
            this.active = false;
        }
    }

    draw(ctx) {
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.radius, 0, Math.PI*2);
        ctx.fillStyle = this.color;
        ctx.shadowBlur = 10;
        ctx.shadowColor = this.color;
        ctx.fill();
        ctx.shadowBlur = 0;
    }
}

class Enemy {
    constructor(type, wave) {
        this.type = type;
        this.active = true;
        this.wave = wave;
        
        // Rastgele kenardan doğ (4 yönlü spawn)
        const side = Math.floor(Math.random() * 4);
        if (side === 0) { this.x = Math.random() * window.innerWidth; this.y = -50; }
        else if (side === 1) { this.x = Math.random() * window.innerWidth; this.y = window.innerHeight + 50; }
        else if (side === 2) { this.x = -50; this.y = Math.random() * window.innerHeight; }
        else { this.x = window.innerWidth + 50; this.y = Math.random() * window.innerHeight; }

        // Tipe göre özellikler
        const difficultyMult = 1 + (wave * 0.08); 
        
        if(type === 'drone') { 
            this.speed = 4 * difficultyMult; this.radius = 10; this.color = '#ffaa00'; this.hp = 1;
            const angle = Math.atan2(Game.player.y - this.y, Game.player.x - this.x);
            this.vx = Math.cos(angle) * this.speed; this.vy = Math.sin(angle) * this.speed;
        } else if (type === 'heavy') { 
            this.speed = 1.5 * difficultyMult; this.radius = 30; this.color = '#ff0000'; this.hp = 5;
        } else if (type === 'turret') { 
            this.speed = 0; this.radius = 20; this.color = '#00ff00'; this.hp = 3; this.fireTimer = 100;
        } else if (type === 'boss') { 
            this.speed = 1 + (wave * 0.01); this.radius = 60; this.color = '#fff'; this.hp = 20 + (wave * 2); this.isBoss = true;
        } else { // Seeker (Normal)
            this.speed = 3 * difficultyMult; this.radius = 15; this.color = '#00ffff'; this.hp = 1;
        }
    }

    update(player) {
        if(this.type === 'drone') {
            this.x += this.vx; this.y += this.vy;
        } else if (this.type === 'turret') {
            // Turret hareketsiz kalır, ama ateş eder
            this.fireTimer--;
            if (this.fireTimer <= 0) {
                this.shootPlayer();
                this.fireTimer = 150; // Tekrar ateş etme süresi
            }
        } else {
            // Oyuncuyu takip et
            const dx = player.x - this.x;
            const dy = player.y - this.y;
            const dist = Math.sqrt(dx*dx + dy*dy);
            if (dist > 0) {
                this.x += (dx/dist) * this.speed;
                this.y += (dy/dist) * this.speed;
            }
        }
    }
    
    shootPlayer() {
        const dx = Game.player.x - this.x;
        const dy = Game.player.y - this.y;
        const dist = Math.sqrt(dx*dx + dy*dy);
        
        if (dist > 0) {
            // Düşman mermisi daha yavaş ve farklı renk
            Game.enemyShots.push(new EnemyShot(this.x, this.y, dx / dist, dy / dist));
            AudioEngine.playTone(300, 'square', 0.1, 0.05); // Turret sesi
        }
    }

    draw(ctx) {
        ctx.beginPath();
        if(this.isBoss) {
            const pulse = 6 * (this.hp / 200);
            ctx.arc(this.x, this.y, this.radius + Math.sin(Date.now()*0.01)*pulse, 0, Math.PI*2);
            ctx.strokeStyle = this.color; ctx.lineWidth = 5; ctx.stroke();
            ctx.font = '12px Orbitron'; ctx.fillStyle = '#fff'; ctx.textAlign = 'center';
            ctx.fillText(`HP: ${Math.max(0, Math.floor(this.hp))}`, this.x, this.y - this.radius - 10);
        } else if (this.type === 'heavy') {
             ctx.rect(this.x - this.radius, this.y - this.radius, this.radius*2, this.radius*2);
             ctx.fillStyle = this.color; ctx.fill();
        } else if (this.type === 'turret') {
            // Turret'ı üçgen şeklinde çiz
            ctx.moveTo(this.x, this.y - this.radius);
            ctx.lineTo(this.x + this.radius, this.y + this.radius);
            ctx.lineTo(this.x - this.radius, this.y + this.radius);
            ctx.closePath();
            ctx.fillStyle = this.color; ctx.fill();
        } else {
            ctx.arc(this.x, this.y, this.radius, 0, Math.PI*2);
            ctx.fillStyle = this.color; ctx.fill();
        }
        ctx.shadowBlur = 0;
    }
}

class EnemyShot extends Shot {
    constructor(x, y, vx, vy) {
        super(x, y, vx, vy);
        this.vx = vx * 10; 
        this.vy = vy * 10;
        this.radius = 5;
        this.color = '#ff0055'; // Kırmızı mermi
        this.damage = 5;
    }
}

// --- ANA OYUN DÖNGÜSÜ ---
const Game = {
    canvas: document.getElementById('gameCanvas'),
    ctx: document.getElementById('gameCanvas').getContext('2d'),
    player: null,
    enemies: [],
    shots: [], // Oyuncu mermileri
    enemyShots: [], // Düşman mermileri
    state: 'menu', 
    wave: 1,
    score: 0,
    waveTimer: 0,
    
    init: function() {
        AudioEngine.init();
        this.canvas.width = window.innerWidth;
        this.canvas.height = window.innerHeight;
        
        this.player = new Player();
        this.enemies = [];
        this.shots = [];
        this.enemyShots = [];
        this.wave = 1;
        this.score = 0;
        this.waveTimer = 0;
        this.state = 'playing';
        this.player.health = 100;
        
        document.getElementById('menuScreen').style.display = 'none';
        document.getElementById('gameOverScreen').style.display = 'none';
        document.getElementById('hud').style.display = 'flex';
        
        this.checkZone();
        AudioEngine.sfx.wave();
        
        // Sağ tıklama menüsünü engelle
        window.oncontextmenu = (e) => { e.preventDefault(); }; 
        
        requestAnimationFrame(() => this.loop());
    },

    restart: function() {
        this.init();
    },

    checkZone: function() {
        let currentZone = Zones[0];
        for(let z of Zones) {
            if(this.wave >= z.start) currentZone = z;
        }
        const titleEl = document.getElementById('zoneTitle');
        titleEl.textContent = `${currentZone.name} - WAVE ${this.wave}`;
        titleEl.style.color = currentZone.color;
        titleEl.style.opacity = 1;
        setTimeout(() => titleEl.style.opacity = 0, 3000);
    },
    
    // Mühimmat Çarpışması Kontrolü
    checkCollisions: function() {
        // Oyuncu Mermisi - Düşman Çarpışması
        this.shots.forEach((shot, sIndex) => {
            this.enemies.forEach((enemy, eIndex) => {
                const dist = Math.sqrt((shot.x - enemy.x)**2 + (shot.y - enemy.y)**2);
                if(dist < shot.radius + enemy.radius) {
                    enemy.hp -= shot.damage;
                    shot.active = false; // Mermi yok oldu
                    VFX.addParticle(shot.x, shot.y, enemy.color, 3, 5);
                }
            });
        });
        
        // Düşman Mermisi - Oyuncu Çarpışması
        this.enemyShots.forEach((eShot, sIndex) => {
            const dist = Math.sqrt((eShot.x - this.player.x)**2 + (eShot.y - this.player.y)**2);
            if(dist < eShot.radius + this.player.radius && !this.player.isDashing) {
                this.player.health -= eShot.damage;
                eShot.active = false;
                VFX.shake(15);
                AudioEngine.sfx.hit();
                VFX.addParticle(eShot.x, eShot.y, this.player.color, 5, 10);

                if(this.player.health <= 0) this.gameOver();
            }
        });
        
        // Oyuncu - Düşman Çarpışması (Dash/Normal)
        this.enemies.forEach(enemy => {
            const dist = Math.sqrt((this.player.x - enemy.x)**2 + (this.player.y - enemy.y)**2);

            if(dist < this.player.radius + enemy.radius) {
                if(this.player.isDashing) { 
                    enemy.hp -= 3; // Dash ile vuruş
                    VFX.shake(5);
                    VFX.addParticle(enemy.x, enemy.y, '#fff', 5, 8);
                } else {
                    this.player.health -= 20;
                    VFX.shake(25);
                    AudioEngine.sfx.hit();
                    
                    if (!enemy.isBoss) {
                        enemy.hp = 0; 
                    } else {
                        enemy.hp -= 1;
                    }
                    if(this.player.health <= 0) this.gameOver();
                }
            }
        });

        // Ölüleri ve mermileri temizle
        this.shots = this.shots.filter(s => s.active);
        this.enemyShots = this.enemyShots.filter(s => s.active);
        
        this.enemies.forEach(enemy => {
            if (enemy.hp <= 0 && enemy.active) {
                enemy.active = false;
                this.score += enemy.isBoss ? 5000 : 100;
                AudioEngine.sfx.collect();
                VFX.shake(8);
                VFX.addParticle(enemy.x, enemy.y, enemy.color, 8, 30);
            }
        });
        this.enemies = this.enemies.filter(e => e.active);
    },

    spawnLogic: function() {
        this.waveTimer++;
        
        if(this.waveTimer > 1200) {
            this.wave++;
            this.waveTimer = 0;
            this.checkZone();
            AudioEngine.sfx.wave();
            this.score += 1000;
            
            if(this.wave % 10 === 0) {
                this.enemies.push(new Enemy('boss', this.wave));
                VFX.shake(20);
            }
        }

        const spawnRate = Math.max(10, 60 - (this.wave * 0.8)); // Daha agresif zorluk eğrisi
        
        if(this.waveTimer % Math.floor(spawnRate) === 0) {
            let zone = Zones.find(z => this.wave >= z.start && this.wave <= z.end) || Zones[Zones.length-1];
            let types = zone.enemyTypes;
            if(types[0] === 'all') types = ['seeker', 'drone', 'heavy', 'turret'];
            
            let type = types[Math.floor(Math.random() * types.length)];
            this.enemies.push(new Enemy(type, this.wave));
        }
    },

    loop: function() {
        if(this.state !== 'playing') return;

        // 1. Ekranı Temizle (Trail efekti)
        this.ctx.fillStyle = 'rgba(5, 5, 5, 0.3)';
        this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
        
        this.ctx.save();
        VFX.update(this.ctx);

        // 2. Güncelleme Sırası: Önce Oyuncu, Sonra Mermiler, Sonra Düşmanlar
        this.player.update();
        this.shots.forEach(shot => shot.update());
        this.enemyShots.forEach(shot => shot.update());
        this.enemies.forEach(enemy => enemy.update(this.player));

        // 3. Çarpışma Kontrolü
        this.checkCollisions();
        
        // 4. Çizim Sırası: Önce Düşmanlar, Sonra Mermiler, En Son Oyuncu
        this.enemies.forEach(enemy => enemy.draw(this.ctx));
        this.shots.forEach(shot => shot.draw(this.ctx));
        this.enemyShots.forEach(shot => shot.draw(this.ctx));
        this.player.draw(this.ctx);

        this.ctx.restore();

        // 5. UI Güncelle
        this.score += 1;
        document.getElementById('scoreVal').textContent = Math.floor(this.score);
        document.getElementById('waveVal').textContent = this.wave;
        document.getElementById('healthVal').textContent = this.player.health + "%";
        
        const healthEl = document.getElementById('healthVal');
        healthEl.style.color = this.player.health > 70 ? '#00ff00' : 
                               this.player.health > 40 ? '#ffaa00' : '#ff0055';

        requestAnimationFrame(() => this.loop());
    },

    gameOver: function() {
        this.state = 'gameover';
        document.getElementById('finalWave').textContent = this.wave;
        document.getElementById('finalScore').textContent = Math.floor(this.score);
        document.getElementById('hud').style.display = 'none';
        document.getElementById('gameOverScreen').style.display = 'flex';
    }
};

// --- GİRİŞ KONTROLLERİ (PC ODAKLI) ---
const keyStates = {};

function handleInput(x, y) {
    if(Game.player) {
        // Fare koordinatlarını Canvas'ın içinde düzelt
        const rect = Game.canvas.getBoundingClientRect();
        Game.player.targetX = x - rect.left;
        Game.player.targetY = y - rect.top;
    }
}

// Fare hareketleri
window.addEventListener('mousemove', e => {
    handleInput(e.clientX, e.clientY);
});

// Sol Tık (Ateş etme)
window.addEventListener('mousedown', e => {
    if(Game.player && Game.state === 'playing') {
        if (e.button === 0) { // Sol tık
            Game.player.shoot();
        } else if (e.button === 2) { // Sağ tık
            Game.player.dash();
        }
    }
});

// Klavye (WASD ile Yönlendirme ve Space ile Dash)
window.addEventListener('keydown', e => {
    keyStates[e.code] = true;
    if(e.code === 'Space' && Game.player && Game.state === 'playing') {
        Game.player.dash();
    }
    Game.player.keys = keyStates;
});

window.addEventListener('keyup', e => {
    keyStates[e.code] = false;
    Game.player.keys = keyStates;
});

// Canvas yeniden boyutlandırma
window.addEventListener('resize', () => {
    Game.canvas.width = window.innerWidth;
    Game.canvas.height = window.innerHeight;
});

// Oyun başladığında ses sistemini init et (Tarayıcı için)
AudioEngine.init();

</script>
</body>
</html>
